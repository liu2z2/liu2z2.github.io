<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Liu" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="project, Projects, " />

<meta property="og:title" content="Using Google Calendar API to Auto-Create Tutoring Events "/>
<meta property="og:url" content="https://liu2z2.github.io/articles/20191021-using-google-calendar-api-to-auto-create-tutoring-events" />
<meta property="og:description" content="The source of the project can be found here. This is a project I started personally since March 2019 when I worked as a peer tutor at UC Tutoring Center (previously called Learning Commons). Motivation¶ The way Peer Tutoring works at UC is that students schedule appointments with me, and …" />
<meta property="og:site_name" content="Liu&#39;s ePortfolio" />
<meta property="og:article:author" content="Liu" />
<meta property="og:article:published_time" content="2019-10-21T00:00:00-04:00" />
<meta name="twitter:title" content="Using Google Calendar API to Auto-Create Tutoring Events ">
<meta name="twitter:description" content="The source of the project can be found here. This is a project I started personally since March 2019 when I worked as a peer tutor at UC Tutoring Center (previously called Learning Commons). Motivation¶ The way Peer Tutoring works at UC is that students schedule appointments with me, and …">

        <title>Using Google Calendar API to Auto-Create Tutoring Events  · Liu&#39;s ePortfolio
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://liu2z2.github.io/theme/css/style.min.css?bec7d543">

        <link href="https://liu2z2.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Liu&#39;s ePortfolio - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://liu2z2.github.io/"><span class=site-name>Liu's ePortfolio</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://liu2z2.github.io
                                    >Home</a>
                                </li>
                                <li><a href="https://liu2z2.github.io/pro-exp.html">Professional Experience</a></li>
                                <li ><a href="https://liu2z2.github.io/categories">Posts</a></li>
                                <li ><a href="https://liu2z2.github.io/tags">Tags</a></li>
                                <li ><a href="https://liu2z2.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://liu2z2.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://liu2z2.github.io/articles/20191021-using-google-calendar-api-to-auto-create-tutoring-events">
                Using Google Calendar API to Auto-Create Tutoring Events
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#design">Design</a><ul>
<li><a href="#design-diagram">Design diagram</a></li>
<li><a href="#reading-uc-email-notifications">Reading UC Email Notifications</a></li>
<li><a href="#main-program">Main Program</a></li>
<li><a href="#hardware-implementation">Hardware Implementation</a></li>
<li><a href="#long-term-management-and-maintenance">Long-Term Management and Maintenance</a></li>
</ul>
</li>
<li><a href="#results">Results</a></li>
<li><a href="#what-i-learned-from-the-project">What I Learned From the Project</a></li>
<li><a href="#future-recommendations">Future Recommendations</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<p>The source of the project can be found <a href="https://github.com/liu2z2/TutorCal">here</a>.</p>
<p>This is a project I started personally since March 2019 when I worked as a peer tutor at UC Tutoring Center (previously called Learning Commons). </p>
<h3 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">¶</a></h3>
<p>The way Peer Tutoring works at UC is that students schedule appointments with me, and I get email notification when they do so. TutorTrac is a system where students schedule appointments, and I see my appointments beforehand. An example of how the system looks is shown in Figure 1. However, though being a stable system maintained since 2011, TutorTrac has some inconvenient features</p>
<ul>
<li>It is hard for me to navigate when I use my phone to look at my schedule</li>
<li>For every event, it shows Last name first, but we usually refer to students’ first name</li>
<li>It only shows the class code of the assisting course instead of full name, making me hard to identify the class</li>
</ul>
<p>This encourages me to develop my own method of seeing the schedule.</p>
<figure>
<img src="/images/project-tutorcal/tutortrac.webp"/>
<figcaption> <small> Figure 1 - TutorTrac System </small> </figcaption>
</figure>
<h3 id="design">Design<a class="headerlink" href="#design" title="Permanent link">¶</a></h3>
<p>The system reads the email notification of incoming tutoring appointments, scrapes the necessary information, and pushes it to my Google calendar in a better format. Thus I can see my schedule directly from the calendar widget of my phone (Android). Ideally it should scan the email notifications every 10-30 minutes and automatically generate events without being monitored. Additional good-to-have feature is that it will also store the appointment info at local, and try to match everyday’s schedule reminder sent from TutorTrac. Later it was found this part was hard to implement given the time, so it was deserted. </p>
<h4 id="design-diagram">Design diagram<a class="headerlink" href="#design-diagram" title="Permanent link">¶</a></h4>
<figure>
<img src="/images/project-tutorcal/design.webp"/>
<figcaption> <small> Figure 2 - Design Diagram </small> </figcaption>
</figure>
<h4 id="reading-uc-email-notifications">Reading UC Email Notifications<a class="headerlink" href="#reading-uc-email-notifications" title="Permanent link">¶</a></h4>
<p>The notification received from TutorTrac follows a specific format (Figure 3). Therefore it is viable to hard-code the format into the program, making the scraping info method easier. Additionally, considering UC email is my most important mail address, as well as the fact that getting around UC server is hard and possibly not allowed, I created a rule at my UC mailbox to automatically forward any emails from TutorTrac to a gmail account I created for this project. </p>
<figure>
<img src="/images/project-tutorcal/email.webp"/>
<figcaption> <small> Figure 3 - TutorTrac Email Notif </small> </figcaption>
</figure>
<h4 id="main-program">Main Program<a class="headerlink" href="#main-program" title="Permanent link">¶</a></h4>
<p>The program is made up of three python scripts. </p>
<p><code>email_read.py</code>: contains functions that reads email from Gmail account and scrape appointment info. Email interface is through imaplib module. Additionally, there is a csv look-up table, where the program can find the matching full name of the class from the course code. </p>
<p><code>google_cal.py</code>: contains functions that pushes the appointment info to my Google calendar. This script is inspired by an article on Google site <a href="https://developers.google.com/calendar/quickstart/python">Google Calendar API Python Quickstart</a></p>
<p><code>controller.py</code>: uses the two modules and sets up the logging.</p>
<h4 id="hardware-implementation">Hardware Implementation<a class="headerlink" href="#hardware-implementation" title="Permanent link">¶</a></h4>
<p>The project does not requires too much in hardware except for the ability to run Python scripts and Internet accessibility. Therefore a Raspberry Pi 3 Model B (Figure 4) was used to implement the design. VNC Viewer is used to remote control the machine wirelessly from other computers. Raspbian with Kernel verion 4.14 was installed on the board, where it was found that there is a Scheduling tool (Figure 5) that lets a command run every period of time. This can also be done by hard-coding in CRON, which is the core of scheduling tool (i.e. scheduling is a GUI of CRON). Detail info about using CRON or scheduling tool see /CRONtest/note.txt on GitHub repo. </p>
<figure>
<img src="/images/project-tutorcal/rpi.webp"/>
<figcaption> <small> Figure 4 - Raspberry Pi 3 in Operation </small> </figcaption>
</figure>
<figure>
<img src="/images/project-tutorcal/rpi.webp"/>
<figcaption> <small> Figure 5 - Cron Task Setup </small> </figcaption>
</figure>
<h4 id="long-term-management-and-maintenance">Long-Term Management and Maintenance<a class="headerlink" href="#long-term-management-and-maintenance" title="Permanent link">¶</a></h4>
<p>To make sure the program runs completely without errors stopping the process, I changed the script so that the error message will show in log file while the erroneous part is passed. Using <code>logging</code> module, the code also logs important stages in the operations (Figure 6). I also coded parts where the Internet is used to push/pull data to allow 99 retries, reducing the odds of getting bad connections. </p>
<figure>
<img src="/images/project-tutorcal/log.webp"/>
<figcaption> <small> Figure 6 - Cron Task Setup </small> </figcaption>
</figure>
<h3 id="results">Results<a class="headerlink" href="#results" title="Permanent link">¶</a></h3>
<p>The project was successful. It helped me manage my tutoring schedule over the last month of the semester. I was able to see who scheduled what class at my phone easily. Figure 8 is a side-by-side comparison between TutorTrac and how it turns out in my Google calendar. </p>
<figure>
<img src="/images/project-tutorcal/gcal.webp"/>
<figcaption> <small> Figure 7 - TutorTrac schedule (left, yellow blocks) vs Google Calendar (right, blue blocks) </small> </figcaption>
</figure>
<h3 id="what-i-learned-from-the-project">What I Learned From the Project<a class="headerlink" href="#what-i-learned-from-the-project" title="Permanent link">¶</a></h3>
<ul>
<li>Access emails in Python with imaplib</li>
<li>Create Google calendar events with Google API</li>
<li>Use logging to maintain a constantly running program</li>
<li>Create a hardware environment (Raspberry Pi) and method to support a mini-server</li>
</ul>
<h3 id="future-recommendations">Future Recommendations<a class="headerlink" href="#future-recommendations" title="Permanent link">¶</a></h3>
<p>Pushing events can be easy, but retrieving them from my calendar may be hard. For future implementation, it will be good to have an additional module to retrieve the events, check with the local record, thus making sure the schedule is correct. </p>


             
 
            
            
            






            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="https://liu2z2.github.io/articles/20190901-college-third-year-in-review" title="Previous: College Third Year-In Review">College Third Year-In Review</a></li>
                <li class="next-article"><a href="https://liu2z2.github.io/articles/20191021-mathematical-steady-state-analysis-by-plotting-in-python" title="Next: Mathematical Steady State Analysis by Plotting in Python">Mathematical Steady State Analysis by Plotting in Python</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2019-10-21T00:00:00-04:00">Oct 21, 2019</time>
            <h4>Category</h4>
            <a class="category-link" href="https://liu2z2.github.io/categories#projects-ref">Projects</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://liu2z2.github.io/tags#project-ref">project
                    <span>3</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="mailto:liu2z2@mail.uc.edu" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Mail" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#328cff"/><path d="m250 186c-46 0-69 35-69 74 0 44 29 72 68 72 43 0 73-32 73-75 0-44-34-71-72-71zm-1-37c30 0 57 13 77 33 0-22 35-22 35 1v150c-1 10 10 16 16 9 25-25 54-128-14-187-64-56-149-47-195-15-48 33-79 107-49 175 33 76 126 99 182 76 28-12 41 26 12 39-45 19-168 17-225-82-38-68-36-185 67-248 78-46 182-33 244 32 66 69 62 197-2 246-28 23-71 1-71-32v-11c-20 20-47 32-77 32-57 0-108-51-108-108 0-58 51-110 108-110" fill="#fff"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/liu-uc/" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://github.com/liu2z2" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        Content licensed under <a rel="license nofollow noopener noreferrer"
    href="https://www.gnu.org/licenses/gpl-3.0.en.html" target="_blank">
    The GNU General Public License v3.0</a>.
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
        Hosted on:
        <a href=https://github.com/liu2z2/liu2z2.github.io target="_blank" rel="nofollow noopener noreferrer">
            GitHub
        </a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>